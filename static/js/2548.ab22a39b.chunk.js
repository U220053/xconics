"use strict";(self.webpackChunk_minimal_kit_cra_js=self.webpackChunk_minimal_kit_cra_js||[]).push([[2548],{57819:function(n,e,r){r.d(e,{ZP:function(){return k},NX:function(){return o}});var t=r(29439),i=r(72791);function o(n){var e=(0,i.useState)(-1),r=(0,t.Z)(e,2),o=r[0],a=r[1];return{selected:o,open:o>=0,onOpen:(0,i.useCallback)((function(e){var r=n.findIndex((function(n){return"video"===n.type?n.poster===e:n.src===e}));a(r)}),[n]),onClose:(0,i.useCallback)((function(){a(-1)}),[]),setSelected:a}}var a=r(1413),s=r(45987),c=r(62291),l=r(70482),d=r(98628),u=r(73557),h=r(19375),p=r(38559),x=r(36654),f=r(64554),m=r(44e3),v=r(13967),Z=r(12065),g=r(6199),b=r(80184);function j(){var n=(0,v.Z)();return(0,b.jsx)(g.Z,{styles:{".yarl__root":{"--yarl__thumbnails_thumbnail_padding":0,"--yarl__thumbnails_thumbnail_border":"transparent","--yarl__color_backdrop":(0,Z.Fq)(n.palette.grey[900],.9),"--yarl__slide_captions_container_background":(0,Z.Fq)(n.palette.grey[900],.48)},".yarl__slide_title":{fontSize:n.typography.h5.fontSize,fontWeight:n.typography.h5.fontWeight,lineHeight:n.typography.h5.lineHeight},".yarl__slide_description":{fontSize:n.typography.body2.fontSize,fontWeight:n.typography.body2.fontWeight,lineHeight:n.typography.body2.lineHeight},".yarl__button":{filter:"unset"},".yarl__thumbnails_thumbnail":{opacity:.48,"&.yarl__thumbnails_thumbnail_active":{opacity:1}},".yarl__thumbnails_vignette":{"--yarl__thumbnails_vignette_size":0},".yarl__video_container":{backgroundColor:n.palette.common.black}}})}var y=["slides","disabledZoom","disabledVideo","disabledTotal","disabledCaptions","disabledSlideshow","disabledThumbnails","disabledFullscreen","onGetCurrentIndex"],w=24;function k(n){var e=n.slides,r=n.disabledZoom,t=n.disabledVideo,i=n.disabledTotal,o=n.disabledCaptions,l=n.disabledSlideshow,d=n.disabledThumbnails,u=n.disabledFullscreen,h=n.onGetCurrentIndex,p=(0,s.Z)(n,y),x=e?e.length:0;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{}),(0,b.jsx)(c.ZP,(0,a.Z)({slides:e,animation:{swipe:240},carousel:{finite:x<5},controller:{closeOnBackdropClick:!0},plugins:C({disabledZoom:r,disabledVideo:t,disabledCaptions:o,disabledSlideshow:l,disabledThumbnails:d,disabledFullscreen:u}),on:{view:function(n){var e=n.index;h&&h(e)}},toolbar:{buttons:[(0,b.jsx)(I,{totalItems:x,disabledTotal:i},0),"close"]},render:{iconClose:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:close"})},iconZoomIn:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:zoom-in"})},iconZoomOut:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:zoom-out"})},iconSlideshowPlay:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:play"})},iconSlideshowPause:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:pause"})},iconPrev:function(){return(0,b.jsx)(m.Z,{width:w+8,icon:"carbon:chevron-left"})},iconNext:function(){return(0,b.jsx)(m.Z,{width:w+8,icon:"carbon:chevron-right"})},iconExitFullscreen:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:center-to-fit"})},iconEnterFullscreen:function(){return(0,b.jsx)(m.Z,{width:w,icon:"carbon:fit-to-screen"})}}},p))]})}function C(n){var e=n.disabledZoom,r=n.disabledVideo,t=n.disabledCaptions,i=n.disabledSlideshow,o=n.disabledThumbnails,a=n.disabledFullscreen,s=[u.Z,p.Z,h.Z,x.Z,d.Z,l.Z];return o&&(s=s.filter((function(n){return n!==x.Z}))),t&&(s=s.filter((function(n){return n!==u.Z}))),a&&(s=s.filter((function(n){return n!==p.Z}))),i&&(s=s.filter((function(n){return n!==h.Z}))),e&&(s=s.filter((function(n){return n!==l.Z}))),r&&(s=s.filter((function(n){return n!==d.Z}))),s}function I(n){var e=n.totalItems,r=n.disabledTotal,t=(0,c.oc)().currentIndex;return r?null:(0,b.jsxs)(f.Z,{component:"span",className:"yarl__button",sx:{typography:"body2",alignItems:"center",display:"inline-flex",justifyContent:"center"},children:[(0,b.jsxs)("strong",{children:[" ",t+1," "]})," / ",e]})}},92548:function(n,e,r){r.r(e),r.d(e,{default:function(){return An}});var t=r(6907),i=r(29439),o=r(72791),a=r(57621),s=r(36314),c=r(89164),l=r(4567),d=r(38072),u=r(19208),h=r(51318),p=r(74165),x=r(93433),f=r(1413),m=r(15861),v=r(6075),Z=r.n(v),g=r(44887),b=r(99615),j={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function y(n,e){return w.apply(this,arguments)}function w(){return(w=(0,m.Z)((0,p.Z)().mark((function n(e,r){var t,i;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=[b.Hv.chat,{params:{endpoint:"conversations"}}],i=[b.Hv.chat,{params:{conversationId:e,endpoint:"conversation"}}],(0,g.JG)(i,(function(n){var e=n.conversation;return{conversation:(0,f.Z)((0,f.Z)({},e),{},{messages:[].concat((0,x.Z)(e.messages),[r])})}}),!1),(0,g.JG)(t,(function(n){return{conversations:n.conversations.map((function(n){return n.id===e?(0,f.Z)((0,f.Z)({},n),{},{messages:[].concat((0,x.Z)(n.messages),[r])}):n}))}}),!1);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function k(n){return C.apply(this,arguments)}function C(){return(C=(0,m.Z)((0,p.Z)().mark((function n(e){var r,t,i;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[b.Hv.chat,{params:{endpoint:"conversations"}}],t={conversationData:e},n.next=4,b.ZP.post(b.Hv.chat,t);case 4:return i=n.sent,(0,g.JG)(r,(function(n){var r=[].concat((0,x.Z)(n.conversations),[e]);return(0,f.Z)((0,f.Z)({},n),{},{conversations:r})}),!1),n.abrupt("return",i.data);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function I(n){return _.apply(this,arguments)}function _(){return(_=(0,m.Z)((0,p.Z)().mark((function n(e){var r;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=b.Hv.chat,(0,g.JG)([r,{params:{endpoint:"conversations"}}],(function(n){var r=n.conversations.map((function(n){return n.id===e?(0,f.Z)((0,f.Z)({},n),{},{unreadCount:0}):n}));return(0,f.Z)((0,f.Z)({},n),{},{conversations:r})}),!1);case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var S=r(60720),F=r(13967),T=r(64554),P=r(88654),O=r(13400),R=r(48550),z=r(63466),q=r(53767),U=r(38887),W=r(44e3),D=r(47974);function E(){var n=(0,o.useState)(!1),e=(0,i.Z)(n,2),r=e[0],t=e[1],a=(0,o.useState)(!1),s=(0,i.Z)(a,2),c=s[0],l=s[1],d=(0,o.useCallback)((function(){l((function(n){return!n}))}),[]),u=(0,o.useCallback)((function(){l(!1)}),[]);return{openMobile:r,collapseDesktop:c,onOpenMobile:(0,o.useCallback)((function(){t(!0)}),[]),onCloseMobile:(0,o.useCallback)((function(){t(!1)}),[]),onCloseDesktop:u,onCollapseDesktop:d}}var G=r(31207),H=r(27029),A=r(60220),M=r(76348),N=r(49900),L=r(76278),V=r(80184);function J(n){var e=n.selected,r=n.collapse,t=n.conversation,i=n.onCloseMobile,a=(0,h.I)().user,c=(0,U.F)("up","md"),x=(0,u.tv)(),v=function(n){var e=n.currentUserId,r=n.conversation,t=r.messages,i=r.participants.filter((function(n){return n.id!==e})),o=t[t.length-1],a=i.length>1,s=i.map((function(n){return n.name})).join(", "),c=!!a&&i.map((function(n){return n.status})).includes("online"),l="";if(o){var d=o.senderId===e?"You: ":"",u="image"===o.contentType?"Sent a photo":o.body;l="".concat(d).concat(u)}return{group:a,displayName:s,displayText:l,participants:i,lastActivity:o.createdAt,hasOnlineInGroup:c}}({conversation:t,currentUserId:a.id}),Z=v.group,g=v.displayName,b=v.displayText,j=v.participants,y=v.lastActivity,w=v.hasOnlineInGroup,k=j[0],C=k.name,_=k.avatarUrl,S=k.status,F=(0,o.useCallback)((0,m.Z)((0,p.Z)().mark((function n(){return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c||i(),n.next=4,I(t.id);case 4:x.push("".concat(d.H.dashboard.chat,"?id=").concat(t.id)),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])}))),[t.id,c,i,x]),P=(0,V.jsx)(H.Z,{variant:w?"online":"invisible",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,V.jsx)(M.Z,{variant:"compact",sx:{width:48,height:48},children:j.slice(0,2).map((function(n){return(0,V.jsx)(A.Z,{alt:n.name,src:n.avatarUrl},n.id)}))})}),O=(0,V.jsx)(H.Z,{variant:S,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,V.jsx)(A.Z,{alt:C,src:_,sx:{width:48,height:48}})},S);return(0,V.jsxs)(L.Z,{disableGutters:!0,onClick:F,sx:(0,f.Z)({py:1.5,px:2.5},e&&{bgcolor:"action.selected"}),children:[(0,V.jsx)(H.Z,{color:"error",overlap:"circular",badgeContent:r?t.unreadCount:0,children:Z?P:O}),!r&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(N.Z,{sx:{ml:2},primary:g,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:b,secondaryTypographyProps:{noWrap:!0,component:"span",variant:t.unreadCount?"subtitle2":"body2",color:t.unreadCount?"text.primary":"text.secondary"}}),(0,V.jsxs)(s.Z,{alignItems:"flex-end",sx:{ml:2,height:44},children:[(0,V.jsx)(l.Z,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:(0,G.Z)(new Date(y),{addSuffix:!1})}),!!t.unreadCount&&(0,V.jsx)(T.Z,{sx:{width:8,height:8,bgcolor:"info.main",borderRadius:"50%"}})]})]})]})}var K=r(4942),X=r(94721),Y=r(20068),B=r(82626),$=r(4834),Q=r(12652),nn=r(58406),en=r(52115);function rn(){var n=(0,h.I)().user,e=(0,en.S)(),r=(0,o.useState)("online"),t=(0,i.Z)(r,2),a=t[0],c=t[1],l=(0,o.useCallback)((function(n){c(n.target.value)}),[]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(H.Z,{variant:a,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,V.jsx)(A.Z,{src:null===n||void 0===n?void 0:n.photoURL,alt:null===n||void 0===n?void 0:n.displayName,onClick:e.onOpen,sx:{cursor:"pointer",width:48,height:48}})}),(0,V.jsxs)(en.Z,{open:e.open,onClose:e.onClose,arrow:"top-left",sx:{p:0},children:[(0,V.jsxs)(s.Z,{direction:"row",alignItems:"center",spacing:2,sx:{py:2,pr:1,pl:2.5},children:[(0,V.jsx)(N.Z,{primary:null===n||void 0===n?void 0:n.displayName,secondary:null===n||void 0===n?void 0:n.email,secondaryTypographyProps:{component:"span"}}),(0,V.jsx)(Y.Z,{title:"Log out",children:(0,V.jsx)(O.Z,{color:"error",children:(0,V.jsx)(W.Z,{icon:"ic:round-power-settings-new"})})})]}),(0,V.jsx)(X.Z,{sx:{borderStyle:"dashed"}}),(0,V.jsxs)(s.Z,{sx:{p:1},children:[(0,V.jsxs)(B.Z,{children:[(0,V.jsx)(H.Z,{variant:a,sx:(0,K.Z)({},"& .".concat(Q.Z.badge),{position:"static",m:.75,width:12,height:12,flexShrink:0})}),(0,V.jsx)(nn.Z,{native:!0,fullWidth:!0,value:a,onChange:l,input:(0,V.jsx)($.ZP,{sx:{pl:2}}),inputProps:{sx:{textTransform:"capitalize"}},children:["online","alway","busy","offline"].map((function(n){return(0,V.jsx)("option",{value:n,children:n},n)}))})]}),(0,V.jsxs)(B.Z,{children:[(0,V.jsx)(W.Z,{icon:"solar:user-id-bold",width:24}),"Profile"]}),(0,V.jsxs)(B.Z,{children:[(0,V.jsx)(W.Z,{icon:"eva:settings-2-fill",width:24}),"Settings"]})]})]})]})}var tn=r(45987),on=r(47047),an=["sx"];function sn(n){var e=n.sx,r=(0,tn.Z)(n,an);return(0,V.jsxs)(s.Z,(0,f.Z)((0,f.Z)({spacing:2,direction:"row",alignItems:"center",sx:(0,f.Z)({px:2.5,py:1.5},e)},r),{},{children:[(0,V.jsx)(on.Z,{variant:"circular",sx:{width:48,height:48}}),(0,V.jsxs)(s.Z,{spacing:1,flexGrow:1,children:[(0,V.jsx)(on.Z,{sx:{width:.75,height:10}}),(0,V.jsx)(on.Z,{sx:{width:.5,height:10}})]})]}))}var cn=r(96349);function ln(n){var e=n.query,r=n.results,t=n.onClickResult,i=r.length,o=!i&&!!e;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(l.Z,{variant:"h6",sx:{px:2.5,mb:2},children:["Contacts (",i,")"]}),o?(0,V.jsx)(cn.Z,{query:e,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}):(0,V.jsx)(V.Fragment,{children:r.map((function(n){return(0,V.jsxs)(L.Z,{onClick:function(){return t(n)},sx:{px:2.5,py:1.5,typography:"subtitle2"},children:[(0,V.jsx)(A.Z,{alt:n.name,src:n.avatarUrl,sx:{mr:2}}),n.name]},n.id)}))})]})}var dn=320,un=96;function hn(n){var e=n.loading,r=n.contacts,t=n.conversations,a=n.selectedConversationId,c=(0,F.Z)(),l=(0,u.tv)(),h=(0,U.F)("up","md"),p=E(),m=p.collapseDesktop,v=p.onCloseDesktop,Z=p.onCollapseDesktop,g=p.openMobile,b=p.onOpenMobile,j=p.onCloseMobile,y=(0,o.useState)({query:"",results:[]}),w=(0,i.Z)(y,2),k=w[0],C=w[1];(0,o.useEffect)((function(){h||v()}),[v,h]);var I=(0,o.useCallback)((function(){h?Z():j()}),[h,j,Z]),_=(0,o.useCallback)((function(){h||j(),l.push(d.H.dashboard.chat)}),[h,j,l]),S=(0,o.useCallback)((function(n){if(C((function(e){return(0,f.Z)((0,f.Z)({},e),{},{query:n})})),n){var e=r.filter((function(e){return e.name.toLowerCase().includes(n)}));C((function(n){return(0,f.Z)((0,f.Z)({},n),{},{results:e})}))}}),[r]),G=(0,o.useCallback)((function(){C({query:"",results:[]})}),[]),H=(0,o.useCallback)((function(n){G(),l.push("".concat(d.H.dashboard.chat,"?id=").concat(n.id))}),[G,l]),A=(0,V.jsx)(O.Z,{onClick:b,sx:{left:0,top:84,zIndex:9,width:32,height:32,position:"absolute",borderRadius:"0 12px 12px 0",bgcolor:c.palette.primary.main,boxShadow:c.customShadows.primary,color:c.palette.primary.contrastText,"&:hover":{bgcolor:c.palette.primary.darker}},children:(0,V.jsx)(W.Z,{width:16,icon:"solar:users-group-rounded-bold"})}),M=(0,V.jsx)(V.Fragment,{children:(0,x.Z)(Array(12)).map((function(n,e){return(0,V.jsx)(sn,{},e)}))}),N=(0,V.jsx)(V.Fragment,{children:t.allIds.map((function(n){return(0,V.jsx)(J,{collapse:m,conversation:t.byId[n],selected:n===a,onCloseMobile:j},n)}))}),L=(0,V.jsx)(ln,{query:k.query,results:k.results,onClickResult:H}),K=(0,V.jsx)(q.d,{onClickAway:G,children:(0,V.jsx)(R.Z,{fullWidth:!0,value:k.query,onChange:function(n){return S(n.target.value)},placeholder:"Search contacts...",InputProps:{startAdornment:(0,V.jsx)(z.Z,{position:"start",children:(0,V.jsx)(W.Z,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{mt:2.5}})}),X=(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"center",sx:{p:2.5,pb:0},children:[!m&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(rn,{}),(0,V.jsx)(T.Z,{sx:{flexGrow:1}})]}),(0,V.jsx)(O.Z,{onClick:I,children:(0,V.jsx)(W.Z,{icon:m?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),!m&&(0,V.jsx)(O.Z,{onClick:_,children:(0,V.jsx)(W.Z,{width:24,icon:"solar:user-plus-bold"})})]}),(0,V.jsx)(T.Z,{sx:{p:2.5,pt:0},children:!m&&K}),(0,V.jsxs)(D.Z,{sx:{pb:1},children:[k.query&&L,e&&M,!k.query&&!!t.allIds.length&&N]})]});return(0,V.jsxs)(V.Fragment,{children:[!h&&A,h?(0,V.jsx)(s.Z,{sx:(0,f.Z)({height:1,flexShrink:0,width:dn,borderRight:"solid 1px ".concat(c.palette.divider),transition:c.transitions.create(["width"],{duration:c.transitions.duration.shorter})},m&&{width:un}),children:X}):(0,V.jsx)(P.ZP,{open:g,onClose:j,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:dn}},children:X})]})}var pn=r(72064),xn=r.n(pn),fn=r(25506),mn=r.n(fn),vn=r(56125),Zn=r(22459),gn=r(12065),bn=r(5574),jn=r(39157);function yn(n){var e=n.participant,r=n.open,t=n.onClose;return(0,V.jsxs)(bn.Z,{fullWidth:!0,maxWidth:"xs",open:r,onClose:t,children:[(0,V.jsx)(O.Z,{onClick:t,sx:{position:"absolute",right:8,top:8},children:(0,V.jsx)(W.Z,{icon:"mingcute:close-line"})}),(0,V.jsxs)(jn.Z,{sx:{py:5,px:3,display:"flex"},children:[(0,V.jsx)(A.Z,{alt:e.name,src:e.avatarUrl,sx:{width:96,height:96,mr:3}}),(0,V.jsxs)(s.Z,{spacing:1,children:[(0,V.jsx)(l.Z,{variant:"caption",sx:{color:"primary.main"},children:e.role}),(0,V.jsx)(l.Z,{variant:"subtitle1",children:e.name}),(0,V.jsxs)(s.Z,{direction:"row",sx:{typography:"caption",color:"text.disabled"},children:[(0,V.jsx)(W.Z,{icon:"mingcute:location-fill",width:16,sx:{flexShrink:0,mr:.5,mt:"2px"}}),e.address]}),(0,V.jsxs)(s.Z,{spacing:1,direction:"row",sx:{pt:1.5},children:[(0,V.jsx)(O.Z,{size:"small",color:"error",sx:{borderRadius:1,bgcolor:function(n){return(0,gn.Fq)(n.palette.error.main,.08)},"&:hover":{bgcolor:function(n){return(0,gn.Fq)(n.palette.error.main,.16)}}},children:(0,V.jsx)(W.Z,{width:18,icon:"solar:phone-bold"})}),(0,V.jsx)(O.Z,{size:"small",color:"info",sx:{borderRadius:1,bgcolor:function(n){return(0,gn.Fq)(n.palette.info.main,.08)},"&:hover":{bgcolor:function(n){return(0,gn.Fq)(n.palette.info.main,.16)}}},children:(0,V.jsx)(W.Z,{width:18,icon:"solar:chat-round-dots-bold"})}),(0,V.jsx)(O.Z,{size:"small",color:"primary",sx:{borderRadius:1,bgcolor:function(n){return(0,gn.Fq)(n.palette.primary.main,.08)},"&:hover":{bgcolor:function(n){return(0,gn.Fq)(n.palette.primary.main,.16)}}},children:(0,V.jsx)(W.Z,{width:18,icon:"fluent:mail-24-filled"})}),(0,V.jsx)(O.Z,{size:"small",color:"secondary",sx:{borderRadius:1,bgcolor:function(n){return(0,gn.Fq)(n.palette.secondary.main,.08)},"&:hover":{bgcolor:function(n){return(0,gn.Fq)(n.palette.secondary.main,.16)}}},children:(0,V.jsx)(W.Z,{width:18,icon:"solar:videocamera-record-bold"})})]})]})]})]})}function wn(n){var e=n.participants,r=(0,o.useState)(null),t=(0,i.Z)(r,2),a=t[0],s=t[1],c=(0,Zn.k)(!0),l=(0,o.useCallback)((function(n){s(n)}),[]),d=e.length,u=(0,V.jsxs)(L.Z,{onClick:c.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,V.jsxs)(T.Z,{component:"span",sx:{flexGrow:1},children:["In room (",d,")"]}),(0,V.jsx)(W.Z,{width:16,icon:c.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),h=(0,V.jsx)(D.Z,{sx:{height:224},children:e.map((function(n){return(0,V.jsxs)(L.Z,{onClick:function(){return l(n)},children:[(0,V.jsx)(H.Z,{variant:n.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,V.jsx)(A.Z,{alt:n.name,src:n.avatarUrl})}),(0,V.jsx)(N.Z,{sx:{ml:2},primary:n.name,secondary:n.role,primaryTypographyProps:{noWrap:!0,typography:"subtitle2"},secondaryTypographyProps:{noWrap:!0,component:"span",typography:"caption"}})]},n.id)}))});return(0,V.jsxs)(V.Fragment,{children:[u,(0,V.jsx)("div",{children:(0,V.jsx)(vn.Z,{in:c.value,children:h})}),a&&(0,V.jsx)(yn,{participant:a,open:!!a,onClose:function(){s(null)}})]})}function kn(n){var e=n.participant,r=(0,Zn.k)(!0),t=e.name,i=e.avatarUrl,o=e.role,a=e.address,c=e.phoneNumber,d=e.email,u=(0,V.jsxs)(s.Z,{alignItems:"center",sx:{py:5},children:[(0,V.jsx)(A.Z,{alt:t,src:i,sx:{width:96,height:96,mb:2}}),(0,V.jsx)(l.Z,{variant:"subtitle1",children:t}),(0,V.jsx)(l.Z,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:o})]}),h=(0,V.jsxs)(L.Z,{onClick:r.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,V.jsx)(T.Z,{component:"span",sx:{flexGrow:1},children:"Information"}),(0,V.jsx)(W.Z,{width:16,icon:r.value?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"})]}),p=(0,V.jsxs)(s.Z,{spacing:2,sx:{px:2,py:2.5,"& svg":{mr:1,flexShrink:0,color:"text.disabled"}},children:[(0,V.jsxs)(s.Z,{direction:"row",children:[(0,V.jsx)(W.Z,{icon:"mingcute:location-fill"}),(0,V.jsx)(l.Z,{variant:"body2",children:a})]}),(0,V.jsxs)(s.Z,{direction:"row",children:[(0,V.jsx)(W.Z,{icon:"solar:phone-bold"}),(0,V.jsx)(l.Z,{variant:"body2",children:c})]}),(0,V.jsxs)(s.Z,{direction:"row",children:[(0,V.jsx)(W.Z,{icon:"fluent:mail-24-filled"}),(0,V.jsx)(l.Z,{variant:"body2",noWrap:!0,children:d})]})]});return(0,V.jsxs)(V.Fragment,{children:[u,h,(0,V.jsx)("div",{children:(0,V.jsx)(vn.Z,{in:r.value,children:p})})]})}var Cn=r(9145),In=r(18197);function _n(n){var e=n.attachments,r=(0,Zn.k)(!0),t=e.length,i=(0,V.jsxs)(L.Z,{disabled:!e.length,onClick:r.onToggle,sx:{pl:2.5,pr:1.5,height:40,flexShrink:0,flexGrow:"unset",typography:"overline",color:"text.secondary",bgcolor:"background.neutral"},children:[(0,V.jsxs)(T.Z,{component:"span",sx:{flexGrow:1},children:["Attachments (",t,")"]}),(0,V.jsx)(W.Z,{width:16,icon:(r.value?!e.length&&"eva:arrow-ios-forward-fill":"eva:arrow-ios-forward-fill")||"eva:arrow-ios-downward-fill"})]}),o=(0,V.jsx)(D.Z,{sx:{px:2,py:2.5},children:e.map((function(n,e){return(0,V.jsxs)(s.Z,{spacing:1.5,direction:"row",alignItems:"center",sx:{mb:2},children:[(0,V.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:(0,V.jsx)(In.ZP,{imageView:!0,file:n.preview,onDownload:function(){return console.info("DOWNLOAD")},sx:{width:28,height:28}})}),(0,V.jsx)(N.Z,{primary:n.name,secondary:(0,Cn.zM)(n.createdAt),primaryTypographyProps:{noWrap:!0,typography:"body2"},secondaryTypographyProps:{mt:.25,noWrap:!0,component:"span",typography:"caption",color:"text.disabled"}})]},n.name+e)}))});return(0,V.jsxs)(V.Fragment,{children:[i,(0,V.jsx)(T.Z,{sx:{overflow:"hidden",height:r.value?1:0,transition:function(n){return n.transitions.create(["height"],{duration:n.transitions.duration.shorter})}},children:o})]})}var Sn=240;function Fn(n){var e=n.participants,r=n.conversation,t=(0,F.Z)(),i=(0,U.F)("up","lg"),a=E(),c=a.collapseDesktop,l=a.onCloseDesktop,d=a.onCollapseDesktop,u=a.openMobile,h=a.onOpenMobile,p=a.onCloseMobile;(0,o.useEffect)((function(){i||l()}),[l,i]);var x=(0,o.useCallback)((function(){i?d():h()}),[i]),m=e.length>1,v=xn()(mn()(r.messages.map((function(n){return n.attachments})))),Z=(0,V.jsxs)(V.Fragment,{children:[m?(0,V.jsx)(wn,{participants:e}):(0,V.jsx)(kn,{participant:e[0]}),(0,V.jsx)(_n,{attachments:v})]}),g=(0,V.jsx)(O.Z,{onClick:x,sx:(0,f.Z)({top:12,right:0,zIndex:9,width:32,height:32,borderRight:0,position:"absolute",borderRadius:"12px 0 0 12px",boxShadow:t.customShadows.z8,bgcolor:t.palette.background.paper,border:"solid 1px ".concat(t.palette.divider),"&:hover":{bgcolor:t.palette.background.neutral}},i&&(0,f.Z)({},!c&&{right:Sn})),children:i?(0,V.jsx)(W.Z,{width:16,icon:c?"eva:arrow-ios-back-fill":"eva:arrow-ios-forward-fill"}):(0,V.jsx)(W.Z,{width:16,icon:"eva:arrow-ios-back-fill"})});return(0,V.jsxs)(T.Z,{sx:{position:"relative"},children:[g,i?(0,V.jsx)(s.Z,{sx:(0,f.Z)({height:1,flexShrink:0,width:Sn,borderLeft:"solid 1px ".concat(t.palette.divider),transition:t.transitions.create(["width"],{duration:t.transitions.duration.shorter})},c&&{width:0}),children:!c&&Z}):(0,V.jsx)(P.ZP,{anchor:"right",open:u,onClose:p,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:Sn}},children:Z})]})}var Tn=r(57819);function Pn(n){var e=n.message,r=n.participants,t=n.onOpenLightbox,i=function(n){var e=n.message,r=n.participants,t=n.currentUserId,i=r.find((function(n){return n.id===e.senderId})),o=e.senderId===t?{type:"me"}:{avatarUrl:null===i||void 0===i?void 0:i.avatarUrl,firstName:null===i||void 0===i?void 0:i.name.split(" ")[0]},a="me"===o.type;return{hasImage:"image"===e.contentType,me:a,senderDetails:o}}({message:e,participants:r,currentUserId:(0,h.I)().user.id}),o=i.me,a=i.senderDetails,c=i.hasImage,d=a.firstName,u=a.avatarUrl,p=e.body,x=e.createdAt,m=(0,V.jsxs)(l.Z,{noWrap:!0,variant:"caption",sx:(0,f.Z)({mb:1,color:"text.disabled"},!o&&{mr:"auto"}),children:[!o&&"".concat(d,",")," \xa0",(0,G.Z)(new Date(x),{addSuffix:!0})]}),v=(0,V.jsx)(s.Z,{sx:(0,f.Z)((0,f.Z)({p:1.5,minWidth:48,maxWidth:320,borderRadius:1,typography:"body2",bgcolor:"background.neutral"},o&&{color:"grey.800",bgcolor:"primary.lighter"}),c&&{p:0,bgcolor:"transparent"}),children:c?(0,V.jsx)(T.Z,{component:"img",alt:"attachment",src:p,onClick:function(){return t(p)},sx:{minHeight:220,borderRadius:1.5,cursor:"pointer","&:hover":{opacity:.9}}}):p}),Z=(0,V.jsxs)(s.Z,{direction:"row",className:"message-actions",sx:(0,f.Z)({pt:.5,opacity:0,top:"100%",left:0,position:"absolute",transition:function(n){return n.transitions.create(["opacity"],{duration:n.transitions.duration.shorter})}},o&&{left:"unset",right:0}),children:[(0,V.jsx)(O.Z,{size:"small",children:(0,V.jsx)(W.Z,{icon:"solar:reply-bold",width:16})}),(0,V.jsx)(O.Z,{size:"small",children:(0,V.jsx)(W.Z,{icon:"eva:smiling-face-fill",width:16})}),(0,V.jsx)(O.Z,{size:"small",children:(0,V.jsx)(W.Z,{icon:"solar:trash-bin-trash-bold",width:16})})]});return(0,V.jsxs)(s.Z,{direction:"row",justifyContent:o?"flex-end":"unset",sx:{mb:5},children:[!o&&(0,V.jsx)(A.Z,{alt:d,src:u,sx:{width:32,height:32,mr:2}}),(0,V.jsxs)(s.Z,{alignItems:"flex-end",children:[m,(0,V.jsxs)(s.Z,{direction:"row",alignItems:"center",sx:{position:"relative","&:hover":{"& .message-actions":{opacity:1}}},children:[v,Z]})]})]})}function On(n){var e=n.messages,r=void 0===e?[]:e,t=n.participants,i=function(n){var e=(0,o.useRef)(null),r=(0,o.useCallback)((function(){n&&e.current&&e.current&&(e.current.scrollTop=e.current.scrollHeight)}),[n]);return(0,o.useEffect)((function(){r()}),[n]),{messagesEndRef:e}}(r),a=i.messagesEndRef,s=r.filter((function(n){return"image"===n.contentType})).map((function(n){return{src:n.body}})),c=(0,Tn.NX)(s);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(D.Z,{ref:a,sx:{px:3,py:5,height:1},children:(0,V.jsx)(T.Z,{children:r.map((function(n){return(0,V.jsx)(Pn,{message:n,participants:t,onOpenLightbox:function(){return c.onOpen(n.body)}},n.id)}))})}),(0,V.jsx)(Tn.ZP,{index:c.selected,slides:s,open:c.open,close:c.onClose})]})}var Rn=r(41920),zn=r(77393);function qn(n){var e=n.recipients,r=n.onAddRecipients,t=n.disabled,a=n.selectedConversationId,c=(0,u.tv)(),l=(0,h.I)().user,f=(0,o.useRef)(null),v=(0,o.useState)(""),Z=(0,i.Z)(v,2),g=Z[0],b=Z[1],j=(0,o.useMemo)((function(){return{id:l.id,role:l.role,email:l.email,address:l.address,name:l.displayName,lastActivity:new Date,avatarUrl:l.photoURL,phoneNumber:l.phoneNumber,status:"online"}}),[l]),w=(0,o.useMemo)((function(){return{id:(0,zn.Z)(),attachments:[],body:g,contentType:"text",createdAt:(0,Rn.Z)(new Date,{minutes:1}),senderId:j.id}}),[g,j.id]),C=(0,o.useMemo)((function(){return{id:(0,zn.Z)(),messages:[w],participants:[].concat((0,x.Z)(e),[j]),type:e.length>1?"GROUP":"ONE_TO_ONE",unreadCount:0}}),[w,j,e]),I=(0,o.useCallback)((function(){f.current&&f.current.click()}),[]),_=(0,o.useCallback)((function(n){b(n.target.value)}),[]),S=(0,o.useCallback)(function(){var n=(0,m.Z)((0,p.Z)().mark((function n(e){var t;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,"Enter"!==e.key){n.next=14;break}if(!g){n.next=13;break}if(!a){n.next=8;break}return n.next=6,y(a,w);case 6:n.next=13;break;case 8:return n.next=10,k(C);case 10:t=n.sent,c.push("".concat(d.H.dashboard.chat,"?id=").concat(t.conversation.id)),r([]);case 13:b("");case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(0),console.error(n.t0);case 19:case"end":return n.stop()}}),n,null,[[0,16]])})));return function(e){return n.apply(this,arguments)}}(),[C,g,w,r,c,a]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)($.ZP,{value:g,onKeyUp:S,onChange:_,placeholder:"Type a message",disabled:t,startAdornment:(0,V.jsx)(O.Z,{children:(0,V.jsx)(W.Z,{icon:"eva:smiling-face-fill"})}),endAdornment:(0,V.jsxs)(s.Z,{direction:"row",sx:{flexShrink:0},children:[(0,V.jsx)(O.Z,{onClick:I,children:(0,V.jsx)(W.Z,{icon:"solar:gallery-add-bold"})}),(0,V.jsx)(O.Z,{onClick:I,children:(0,V.jsx)(W.Z,{icon:"eva:attach-2-fill"})}),(0,V.jsx)(O.Z,{children:(0,V.jsx)(W.Z,{icon:"solar:microphone-bold"})})]}),sx:{px:1,height:56,flexShrink:0,borderTop:function(n){return"solid 1px ".concat(n.palette.divider)}}}),(0,V.jsx)("input",{type:"file",ref:f,style:{display:"none"}})]})}var Un=r(5951);function Wn(n){var e=n.participants,r=e.length>1,t=e[0],i=(0,V.jsx)(M.Z,{max:3,sx:(0,K.Z)({},"& .".concat(Un.Z.avatar),{width:32,height:32}),children:e.map((function(n){return(0,V.jsx)(A.Z,{alt:n.name,src:n.avatarUrl},n.id)}))}),o=(0,V.jsxs)(s.Z,{flexGrow:1,direction:"row",alignItems:"center",spacing:2,children:[(0,V.jsx)(H.Z,{variant:t.status,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,V.jsx)(A.Z,{src:t.avatarUrl,alt:t.name})}),(0,V.jsx)(N.Z,{primary:t.name,secondary:"offline"===t.status?(0,Cn.DY)(t.lastActivity):t.status,secondaryTypographyProps:(0,f.Z)({component:"span"},"offline"!==t.status&&{textTransform:"capitalize"})})]});return(0,V.jsxs)(V.Fragment,{children:[r?i:o,(0,V.jsx)(s.Z,{flexGrow:1}),(0,V.jsx)(O.Z,{children:(0,V.jsx)(W.Z,{icon:"solar:phone-bold"})}),(0,V.jsx)(O.Z,{children:(0,V.jsx)(W.Z,{icon:"solar:videocamera-record-bold"})}),(0,V.jsx)(O.Z,{children:(0,V.jsx)(W.Z,{icon:"eva:more-vertical-fill"})})]})}var Dn=r(85771),En=r(46314);function Gn(n){var e=n.contacts,r=n.onAddRecipients,t=(0,o.useState)(""),a=(0,i.Z)(t,2),c=a[0],d=a[1],u=(0,o.useCallback)((function(n){d(""),r(n)}),[r]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(l.Z,{variant:"subtitle2",sx:{color:"text.primary",mr:2},children:"To:"}),(0,V.jsx)(En.Z,{sx:{minWidth:320},multiple:!0,limitTags:3,popupIcon:null,disableCloseOnSelect:!0,noOptionsText:(0,V.jsx)(cn.Z,{query:c}),onChange:function(n,e){return u(e)},onInputChange:function(n,e){return d(e)},options:e,getOptionLabel:function(n){return n.name},isOptionEqualToValue:function(n,e){return n.id===e.id},renderInput:function(n){return(0,V.jsx)(R.Z,(0,f.Z)((0,f.Z)({},n),{},{placeholder:"+ Recipients"}))},renderOption:function(n,e,r){var t=r.selected;return(0,o.createElement)("li",(0,f.Z)((0,f.Z)({},n),{},{key:e.id}),(0,V.jsxs)(T.Z,{sx:{mr:1,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[(0,V.jsx)(A.Z,{alt:e.name,src:e.avatarUrl,sx:{width:1,height:1}}),(0,V.jsx)(s.Z,{alignItems:"center",justifyContent:"center",sx:(0,f.Z)({top:0,left:0,width:1,height:1,opacity:0,position:"absolute",bgcolor:function(n){return(0,gn.Fq)(n.palette.grey[900],.8)},transition:function(n){return n.transitions.create(["opacity"],{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.shorter})}},t&&{opacity:1,color:"primary.main"}),children:(0,V.jsx)(W.Z,{icon:"eva:checkmark-fill"})})]},e.id),e.name)},renderTags:function(n,e){return n.map((function(n,r){return(0,o.createElement)(Dn.Z,(0,f.Z)((0,f.Z)({},e({index:r})),{},{key:n.id,label:n.name,avatar:(0,V.jsx)(A.Z,{alt:n.name,src:n.avatarUrl}),size:"small",variant:"soft"}))}))}})]})}function Hn(){var n=(0,u.tv)(),e=(0,h.I)().user,r=(0,S.K$)(),t=(0,u.lr)().get("id")||"",p=(0,o.useState)([]),x=(0,i.Z)(p,2),f=x[0],m=x[1],v=function(){var n=[b.Hv.chat,{params:{endpoint:"contacts"}}],e=(0,g.ZP)(n,b._i,j),r=e.data,t=e.isLoading,i=e.error,a=e.isValidating;return(0,o.useMemo)((function(){return{contacts:(null===r||void 0===r?void 0:r.contacts)||[],contactsLoading:t,contactsError:i,contactsValidating:a,contactsEmpty:!t&&!(null!==r&&void 0!==r&&r.contacts.length)}}),[null===r||void 0===r?void 0:r.contacts,i,t,a])}().contacts,y=function(){var n=[b.Hv.chat,{params:{endpoint:"conversations"}}],e=(0,g.ZP)(n,b._i,j),r=e.data,t=e.isLoading,i=e.error,a=e.isValidating;return(0,o.useMemo)((function(){var n=Z()(null===r||void 0===r?void 0:r.conversations,"id")||{},e=Object.keys(n)||[];return{conversations:{byId:n,allIds:e},conversationsLoading:t,conversationsError:i,conversationsValidating:a,conversationsEmpty:!t&&!e.length}}),[null===r||void 0===r?void 0:r.conversations,i,t,a])}(),w=y.conversations,k=y.conversationsLoading,C=function(n){var e=n?[b.Hv.chat,{params:{conversationId:n,endpoint:"conversation"}}]:null,r=(0,g.ZP)(e,b._i,j),t=r.data,i=r.isLoading,a=r.error,s=r.isValidating;return(0,o.useMemo)((function(){return{conversation:null===t||void 0===t?void 0:t.conversation,conversationLoading:i,conversationError:a,conversationValidating:s}}),[null===t||void 0===t?void 0:t.conversation,a,i,s])}("".concat(t)),I=C.conversation,_=C.conversationError,F=I?I.participants.filter((function(n){return n.id!==e.id})):[];(0,o.useEffect)((function(){!_&&t||n.push(d.H.dashboard.chat)}),[_,n,t]);var T=(0,o.useCallback)((function(n){m(n)}),[]),P=!!I,O=(0,V.jsx)(s.Z,{direction:"row",alignItems:"center",flexShrink:0,sx:{pr:1,pl:2.5,py:1,minHeight:72},children:t?(0,V.jsx)(V.Fragment,{children:P&&(0,V.jsx)(Wn,{participants:F})}):(0,V.jsx)(Gn,{contacts:v,onAddRecipients:T})}),R=(0,V.jsx)(hn,{contacts:v,conversations:w,loading:k,selectedConversationId:t}),z=(0,V.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[(0,V.jsx)(On,{messages:null===I||void 0===I?void 0:I.messages,participants:F}),(0,V.jsx)(qn,{recipients:f,onAddRecipients:T,selectedConversationId:t,disabled:!f.length&&!t})]});return(0,V.jsxs)(c.Z,{maxWidth:!r.themeStretch&&"xl",children:[(0,V.jsx)(l.Z,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Chat"}),(0,V.jsxs)(s.Z,{component:a.Z,direction:"row",sx:{height:"72vh"},children:[R,(0,V.jsxs)(s.Z,{sx:{width:1,height:1,overflow:"hidden"},children:[O,(0,V.jsxs)(s.Z,{direction:"row",sx:{width:1,height:1,overflow:"hidden",borderTop:function(n){return"solid 1px ".concat(n.palette.divider)}},children:[z,P&&(0,V.jsx)(Fn,{conversation:I,participants:F})]})]})]})]})}function An(){return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(t.ql,{children:(0,V.jsx)("title",{children:" Dashboard: Chat"})}),(0,V.jsx)(Hn,{})]})}},77393:function(n,e,r){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var e=16*Math.random()|0;return("x"===n?e:3&e|8).toString(16)}))}r.d(e,{Z:function(){return t}})}}]);
//# sourceMappingURL=2548.ab22a39b.chunk.js.map